<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">

    <style>
      body {
        cursor: none;
      }

      .cursor {
        position: fixed;
        width: 14px;
        height: 14px;
        border-radius: 50%;
        background: rgba(20, 20, 20, 0.9);
        pointer-events: none;
        transform: translate(-50%, -50%);
        z-index: 9999;
      }

      #antigravityCanvas {
        position: fixed;
        inset: 0;
        pointer-events: none;
        z-index: 0;
      }

      .wrapper {
        position: relative;
        z-index: 1;
      }
    </style>

    {% include head-custom.html %}
  </head>

  <body>
    <div class="cursor"></div>
    <canvas id="antigravityCanvas"></canvas>

    <div class="wrapper">
      <header>
        <h1><a href="{{ "/" | absolute_url }}">{{ site.title | default: site.github.repository_name }}</a></h1>

        {% if site.logo %}
          <img src="{{ site.logo | relative_url }}" alt="Logo" />
        {% endif %}

        <p>{{ site.description | default: site.github.project_tagline }}</p>

        <p class="view"><a href="https://www.linkedin.com/in/patilsankalp/">Visit my Linkedin profile</a></p>
        <p class="view"><a href="https://www.researchgate.net/profile/Sankalp-Patil-2">Checkout my ResearchGate profile</a></p>
      </header>

      <section>
        {{ content }}
      </section>

      <footer>
        <p><small>Hosted on GitHub Pages</small></p>
      </footer>
    </div>

    <script src="{{ "/assets/js/scale.fix.js" | relative_url }}"></script>

    <!-- Antigravity Water-Wave Particle System -->
    <script>
      document.addEventListener("DOMContentLoaded", () => {

        /* ---------- Cursor ---------- */
        const cursor = document.querySelector(".cursor");
        document.addEventListener("mousemove", e => {
          cursor.style.left = e.clientX + "px";
          cursor.style.top = e.clientY + "px";
        });

        /* ---------- Canvas ---------- */
        const canvas = document.getElementById("antigravityCanvas");
        const ctx = canvas.getContext("2d");

        function resize() {
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
        }
        resize();
        window.addEventListener("resize", resize);

        /* ---------- Mouse ---------- */
        let mouse = { x: canvas.width / 2, y: canvas.height / 2, speed: 0 };
        let lastMouse = { x: mouse.x, y: mouse.y };

        document.addEventListener("mousemove", e => {
          mouse.x = e.clientX;
          mouse.y = e.clientY;
          mouse.speed = Math.hypot(mouse.x - lastMouse.x, mouse.y - lastMouse.y);
          lastMouse.x = mouse.x;
          lastMouse.y = mouse.y;
        });

        /* ---------- Color Palette (6 colors) ---------- */
        const palette = [
          [88, 101, 242],   // indigo
          [52, 211, 153],   // emerald
          [96, 165, 250],   // sky
          [250, 204, 21],   // amber
          [244, 114, 182],  // pink
          [167, 139, 250]   // violet
        ];

        function lerp(a, b, t) {
          return a + (b - a) * t;
        }

        function colorFromField(x, y) {
          const dx = x - mouse.x;
          const dy = y - mouse.y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          const angle = Math.atan2(dy, dx) + Math.PI;

          const idx = Math.floor((angle / (Math.PI * 2)) * palette.length);
          const next = (idx + 1) % palette.length;

          const t = (dist % 200) / 200;
          const c1 = palette[idx];
          const c2 = palette[next];

          return `rgba(
            ${lerp(c1[0], c2[0], t)},
            ${lerp(c1[1], c2[1], t)},
            ${lerp(c1[2], c2[2], t)},
            0.75
          )`;
        }

        /* ---------- Particles ---------- */
        const particles = [];
        const COUNT = 180;
        const BASE_WAVE = 0.6;

        class Particle {
          constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.baseX = this.x;
            this.baseY = this.y;
            this.vx = 0;
            this.vy = 0;
            this.phase = Math.random() * Math.PI * 2;
            this.radius = Math.random() * 2 + 1;
          }

          update(time) {
            // Water-like idle waves
            const wave = Math.sin(time * 0.002 + this.phase) * BASE_WAVE;
            this.vx += wave * 0.02;
            this.vy += Math.cos(time * 0.002 + this.phase) * BASE_WAVE * 0.02;

            // Cursor amplification
            const dx = this.x - mouse.x;
            const dy = this.y - mouse.y;
            const d = Math.sqrt(dx * dx + dy * dy);

            if (d < 160) {
              const f = (160 - d) / 160;
              this.vx += (dx / d) * f * (mouse.speed * 0.002);
              this.vy += (dy / d) * f * (mouse.speed * 0.002);
            }

            this.vx *= 0.96;
            this.vy *= 0.96;

            this.x += this.vx;
            this.y += this.vy;

            if (this.x < 0) this.x = canvas.width;
            if (this.x > canvas.width) this.x = 0;
            if (this.y < 0) this.y = canvas.height;
            if (this.y > canvas.height) this.y = 0;
          }

          draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = colorFromField(this.x, this.y);
            ctx.fill();
          }
        }

        for (let i = 0; i < COUNT; i++) {
          particles.push(new Particle());
        }

        /* ---------- Animation ---------- */
        function animate(time) {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          particles.forEach(p => {
            p.update(time);
            p.draw();
          });
          requestAnimationFrame(animate);
        }

        animate(0);
      });
    </script>
  </body>
</html>
